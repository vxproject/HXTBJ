<wxs module="orders" src="./order.wxs"></wxs>
<import src="/template/loading/loading.wxml" />
<template is="loading" data="{{loading}}"></template>
<view wx:if="{{hidden == 1}}" class='container'>
  <!-- 导航栏 -->
  <view class='tab_group'>
    <block wx:for="{{topData}}" wx:for-item="item" wx:key="{{index}}">
      <view bindtap='btnClick' data-flag="{{index}}" class='tab_item'>
        <text class='{{seleted == index?"ziti_2 color":"ziti_2 color_gray"}}'>{{item.title}}</text>
        <!-- 底部红边 -->
        <view class='{{seleted == index?"red_line check_style":"red_line"}}'></view>
      </view>
    </block>
  </view>
  <!-- 无订单状态 -->
  <view wx:if="{{!list_data.data[0]}}" class='no_order'>
    <image class='no_order_img' src='../../../images/image/person_order.png'></image>
    <view class='ziti_2 color_gray no_order_txt'>您还没有订单</view>
  </view>
  <!-- 有订单状态 -->
  <view wx:else class='yes_order'>
    <!-- 待付款 -->
    <view wx:if="{{seleted < 2}}" wx:for="{{list_data.data}}" class='order_quxiao order_item' wx:for-index="index">
      <!-- 头部 -->
      <view class='order_item_header'>
        <text class='order_item_header_n ziti_3 color_gray' style='padding-right:30rpx;'>订单编号:{{item.order_sn}}</text>
        <text bindtap='copy' data-copTxt="{{item.order_sn}}" class='ziti_3 color_gray copy' style='padding:5rpx 10rpx;'>复制</text>
        <text class='order_status ziti_3 color_price'>{{orders.getState(item) == -1?"订单取消":orders.getState(item)}}</text>
      </view>
      <!-- 商品详情 -->
      <view wx:for="{{item.goodsInfo}}" wx:for-index="idx" wx:for-item="itemName" data-flag="0" bindtap='orderDetail' data-id="{{item.order_id}}" data-recid="{{item.goodsInfo[0].rec_id}}" data-state="{{item.pay_status}}" class='goods_container'>
        <view class='goods_content mar_center'>
          <image class='goods_content_img' src='{{img_path}}{{itemName.spec_img}}'></image>
          <view class='goods_content_info'>
            <view class='goods_content_info_title ziti_2'>
              {{itemName.goods_name}}
            </view>
            <view class='goods_content_info_spec ziti_3 color_gray'>{{itemName.spec_key_name}}</view>
            <view>
              <text class='ziti_2 color_price'>￥{{itemName.goods_price}}</text>
              <text style='padding-top:5rpx;' class='ziti_2 color_gray flo_right'>x{{itemName.goods_num}}</text>
            </view>
          </view>
          <!-- 收藏图标 -->

        </view>
                  <image catchtap='shouchang' data-bindex="{{index}}" data-index="{{idx}}" data-flag="0" data-item="{{itemName}}" class='order_shoucang_btn' src='{{itemName.is_collectd == 0?"../../../images/order/order_dai_shoucang.png":"../../../images/order/order_yi_shoucang.png"}}'></image>
      </view>
      <!--  -->
      <view class='goods_info_sum'>
        <text class='ziti_3 color_gray'>共{{item.goodsInfo.length}}件商品</text>
        <text style='padding:0 30rpx;' class='ziti_3'>订单金额:￥{{item.order_amount}}</text>
      </view>
      <!--  -->
      <view wx:if="{{item.deleted == 0 && item.pay_status == 0}}" class='goods_info_btn'>
        <view wx:if="{{item.time}}" class='ziti_3 color_price' style='margin-left:200rpx;color:#fd4a20;width:200rpx;'>剩余{{item.time}}</view>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="2" class='goods_item_btn goods_item_btn1 ziti_3 ys1'>立即付款</button>
        <button catchtap="orderClick" data-item="{{item}}" data-flag="1" class='goods_item_btn goods_item_btn2 ziti_3 ys2'>取消订单</button>
      </view>
      <!-- <view wx:if="{{item.deleted == 0 && item.pay_status == 1 && item.goodsInfo[0].is_send==0 && item.goodsInfo[0].return_status==0}}" class='goods_info_btn'>
        <button catchtap="orderClick" data-item="{{item}}" data-flag="1" class='goods_item_btn goods_item_btn1 ziti_3 ys2'>取消订单</button>
      </view> -->
      <view wx:elif="{{item.deleted == 0 && item.pay_status == 1 && item.goodsInfo[0].is_send==1&&item.goodsInfo[0].return_status==0}}" class='goods_info_btn'>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="4" class='goods_item_btn goods_item_btn1 ziti_3 ys1'>确认收货</button>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="3" class='goods_item_btn goods_item_btn2 ziti_3 ys2'>查看物流</button>
      </view>
      <view wx:elif="{{item.deleted == 0 && item.pay_status == 1 && item.goodsInfo[0].is_send==4&&item.goodsInfo[0].return_status==0}}" class='goods_info_btn'>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="5" class='goods_item_btn goods_item_btn1 ziti_3 ys1'>再次购买</button>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="6" wx:if="{{item.goodsInfo[0].is_comment == 0}}" class='goods_item_btn goods_item_btn2 ziti_3 ys1'>评价商品</button>
      </view>
    </view>



    <view wx:if="{{seleted > 1}}"  wx:for="{{list_data.data}}" wx:for-index="idx" class='order_quxiao order_item'>
      <!-- 头部 -->
      <view class='order_item_header'>
        <text class='order_item_header_n ziti_3 color_gray'>订单编号:{{item.order_goods_sn}}</text>
                <text bindtap='copy' data-copTxt="{{item.order_goods_sn}}" class='ziti_3 color_gray copy' style='padding:5rpx 10rpx;'>复制</text>
        <text class='order_status ziti_3 color_price'>{{topData[seleted].title}}</text>
      </view>
      <!-- 商品详情 -->
      <view class='goods_container' bindtap='orderDetail' data-id="{{item.rec_id}}">
        <view class='goods_content mar_center'>
          <image class='goods_content_img' src='{{img_path}}{{item.spec_img}}'></image>
          <view class='goods_content_info'>
            <view class='goods_content_info_title ziti_2'>
              {{item.goods_name}}
            </view>
            <view class='goods_content_info_spec ziti_3 color_gray'>{{item.spec_key_name}}</view>
            <view>
              <text class='ziti_2 color_price'>￥{{item.goods_price}}</text>
              <text style='padding-top:5rpx;' class='ziti_2 color_gray flo_right'>x{{item.goods_num}}</text>
            </view>
          </view>

        </view>
                  <image catchtap='shouchang' data-bindex="{{idx}}" data-item="{{item}}" data-flag="1" data-index="{{idx}}" class='order_shoucang_btn' src='{{item.is_collectd == 0?"../../../images/order/order_dai_shoucang.png":"../../../images/order/order_yi_shoucang.png"}}'></image>
      </view>
      <!--  -->
      <view class='goods_info_sum'>
        <text class='ziti_3 color_gray'>共{{item.goods_num}}件商品</text>
        <text style='padding:0 30rpx;' class='ziti_3'>已支付:￥{{item.goods_price}}</text>
      </view>
      <!--  -->

      <!-- <view wx:if="{{seleted == 2}}" class='goods_info_btn'>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="1" class='goods_item_btn goods_item_btn1 ziti_3 ys2'>取消订单</button>
      </view> -->
      <view wx:if="{{seleted == 3}}" class='goods_info_btn'>


        <button catchtap='orderClick' data-item="{{item}}" data-flag="4" class='goods_item_btn goods_item_btn1 ziti_3 ys1'>确认收货</button>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="3" class='goods_item_btn goods_item_btn2 ziti_3 ys2'>查看物流</button>
        <!-- <button wx:if="{{is_vip == 1}}" catchtap='scClick' data-item="{{item}}" data-flag="4" class='goods_item_btn goods_item_btn2 ziti_3 ys2' style='right:408rpx;width:100rpx;'>收藏</button> -->
      </view>
      <view wx:elif="{{seleted == 4}}" class='goods_info_btn'>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="5" class='goods_item_btn goods_item_btn1 ziti_3 ys1'>再次购买</button>
        <button catchtap='orderClick' data-item="{{item}}" data-flag="6" wx:if="{{item.is_comment == 0}}" class='goods_item_btn goods_item_btn2 ziti_3 ys1'>评价商品</button>
      </view>
    </view>
    <!-- </view> -->





    <!-- 订单取消 -->
    <view class='order_quxiao order_item'>
      <!-- 头部 -->
      <!-- <view class='order_item_header'>
                <text class='order_item_header_n ziti_3 color_gray'>订单编号:N190105105938884587</text>
                <text class='order_status ziti_3 color_price'>订单取消</text>
            </view> -->
      <!-- 商品详情 -->
      <!-- <view class='goods_container'>
                <view class='goods_content mar_center'>
                    <image class='goods_content_img' src=''></image>
                    <view class='goods_content_info'>
                        <view class='goods_content_info_title ziti_2'>
                            当初V及对vieioV额哎如果充分的错误 的据诶哦瑞哦V诶日
                        </view>
                        <view class='goods_content_info_spec ziti_3 color_gray'>500g</view>
                        <view>
                            <text class='ziti_2 color_price'>￥26.90</text>
                            <text style='padding-top:5rpx;' class='ziti_2 color_gray flo_right'>x1</text>
                        </view>
                    </view>
                </view>
            </view> -->
      <!--  -->
      <!-- <view class='goods_info_sum'>
                <text class='ziti_3 color_gray'>共1件商品</text>
                <text style='padding:0 30rpx;' class='ziti_3'>待支付:￥26.90</text>
            </view> -->
    </view>
  </view>


</view>